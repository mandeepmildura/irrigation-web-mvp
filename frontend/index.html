<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Irrigation Dashboard</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 24px;
    }

    h1, h2 {
      margin-bottom: 10px;
    }

    .zone {
      border: 1px solid #ddd;
      padding: 12px;
      margin-bottom: 16px;
      border-radius: 6px;
    }

    button {
      margin-right: 8px;
      padding: 6px 10px;
      cursor: pointer;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 12px;
    }

    th, td {
      border-bottom: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }

    th {
      background: #f4f4f4;
    }
  </style>
</head>
<body>

<h1>ðŸŒ± Irrigation Dashboard</h1>

<h2>Zones</h2>
<div id="zones"></div>

<h2>Recent Runs</h2>
<table>
  <thead>
    <tr>
      <th>Time (Melbourne)</th>
      <th>Zone</th>
      <th>Minutes</th>
      <th>Source</th>
    </tr>
  </thead>
  <tbody id="runs"></tbody>
</table>

<script>
/* ================= CONFIG ================= */
const API = ""; // same domain (Render)

/* ============== TIME FORMAT ============== */
function formatMelbourne(ts) {
  // Backend timestamps have no timezone â†’ force UTC
  const iso = ts.endsWith("Z") ? ts : ts + "Z";
  const d = new Date(iso);

  return new Intl.DateTimeFormat("en-AU", {
    timeZone: "Australia/Melbourne",
    year: "numeric",
    month: "2-digit",
    day: "2-digit",
    hour: "2-digit",
    minute: "2-digit",
    second: "2-digit",
    hour12: false
  }).format(d);
}

/* ============== ZONES ==================== */
async function loadZones() {
  const res = await fetch(`${API}/zones`);
  const zones = awa
